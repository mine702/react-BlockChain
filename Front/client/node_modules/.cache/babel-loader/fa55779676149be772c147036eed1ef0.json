{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\2022\\\\main\\\\Front\\\\client\\\\src\\\\component\\\\ui\\\\Chatting.jsx\",\n    _s = $RefreshSig$();\n\n//#region react\nimport React, { useState, useEffect } from 'react'; //#endregion\n//#region mui\n\nimport ButtonGroup from '@mui/material/ButtonGroup';\nimport Modal from '@mui/material/Modal';\nimport Button from '@mui/material/Button';\nimport TextField from '@mui/material/TextField';\nimport SendIcon from '@mui/icons-material/Send';\nimport io from \"socket.io-client\";\nimport LogText from \"./LogText\";\nimport Box from '@mui/material/Box'; //#endregion\n//#region CSS Style\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst style = {\n  position: 'absolute',\n  top: '50%',\n  left: '50%',\n  transform: 'translate(-50%, -50%)',\n  bgcolor: 'background.paper',\n  height: '80%',\n  width: '40%',\n  border: '2px solid #000',\n  pt: 2,\n  px: 4,\n  pb: 3\n}; //#endregion\n//#region 전역 변수\n\nlet socket; //#endregion\n\nfunction Chatting(props) {\n  _s();\n\n  const ENDPOINT = \"http://localhost:8080\";\n  const {\n    value,\n    buyer_name\n  } = props; //#region useState\n\n  const [modalIsOpen, setIsOpen] = useState(false);\n  const [chat_log, set_Chatlog] = useState([{}]);\n  const [send_msg, set_SendMsg] = useState(\"\");\n  const [Room_Number] = useState(value); //#endregion\n\n  let room_number = 0; //#region 함수가 실행될때 modal의 상태를 true로 바꿔준다.\n\n  function openModal() {\n    room_number = Room_Number;\n    socket.emit(\"Chatting_Join\", {\n      room_number\n    });\n    socket.on('Join_return', _ref => {\n      let {\n        room_number\n      } = _ref;\n      console.log(\"성공\");\n    });\n    socket.emit(\"Load_Msg_Chat\", {\n      Room_Number\n    });\n    socket.on('Return_Load_Msg_Chat', _ref2 => {\n      let {\n        result\n      } = _ref2;\n      set_Chatlog(result);\n    });\n    setIsOpen(true);\n  } //#endregion\n  //#region 함수가 실행될때 modal의 상태를 false로 바꿔준다. \n\n\n  function closeModal() {\n    setIsOpen(false);\n  } //#endregion\n  //#region useEffect\n\n\n  useEffect(() => {\n    socket = io(ENDPOINT);\n  }, [ENDPOINT]);\n  useEffect(() => {\n    socket.on(\"Msg_return\", _ref3 => {\n      let {\n        buyer_name,\n        send_msg\n      } = _ref3;\n      console.log(\"신호\");\n      set_Chatlog([...chat_log, {\n        name: buyer_name,\n        msg: send_msg\n      }]);\n    });\n\n    if (chat_log.length !== 0 && chat_log.length !== 1) {\n      socket.emit(\"Save_Msg\", {\n        chat_log,\n        Room_Number\n      });\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [chat_log]); //#endregion\n  //#region 메세지 전달 함수\n\n  function SendMessage() {\n    socket.emit(\"Message_Send\", {\n      buyer_name,\n      send_msg,\n      Room_Number\n    });\n  } //#endregion\n  //#region 렌더링\n\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      onClick: openModal,\n      children: \"Chatting\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      hideBackdrop: true,\n      open: modalIsOpen,\n      onClose: closeModal,\n      \"aria-labelledby\": \"child-modal-title\",\n      \"aria-describedby\": \"child-modal-description\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        sx: { ...style\n        },\n        children: [/*#__PURE__*/_jsxDEV(LogText, {\n          log: chat_log\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          margin: \"normal\",\n          required: true,\n          fullWidth: true,\n          id: \"Message\",\n          label: \"Message\",\n          name: \"Message\",\n          autoComplete: \"Message\",\n          autoFocus: true,\n          onChange: e => set_SendMsg(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(ButtonGroup, {\n          disableElevation: true,\n          variant: \"contained\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            onClick: () => {\n              closeModal();\n            },\n            children: \"CLOSE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            endIcon: /*#__PURE__*/_jsxDEV(SendIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 125,\n              columnNumber: 62\n            }, this),\n            onClick: () => {\n              SendMessage();\n            },\n            children: \"SEND\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 9\n  }, this); //#endregion\n}\n\n_s(Chatting, \"gQnwMi4ztp3V6BAZ4IPoJnULqG0=\");\n\n_c = Chatting;\nexport default Chatting;\n\nvar _c;\n\n$RefreshReg$(_c, \"Chatting\");","map":{"version":3,"names":["React","useState","useEffect","ButtonGroup","Modal","Button","TextField","SendIcon","io","LogText","Box","style","position","top","left","transform","bgcolor","height","width","border","pt","px","pb","socket","Chatting","props","ENDPOINT","value","buyer_name","modalIsOpen","setIsOpen","chat_log","set_Chatlog","send_msg","set_SendMsg","Room_Number","room_number","openModal","emit","on","console","log","result","closeModal","name","msg","length","SendMessage","e","target"],"sources":["C:/Users/user/Desktop/2022/main/Front/client/src/component/ui/Chatting.jsx"],"sourcesContent":["//#region react\nimport React, { useState, useEffect } from 'react';\n//#endregion\n\n//#region mui\nimport ButtonGroup from '@mui/material/ButtonGroup';\nimport Modal from '@mui/material/Modal';\nimport Button from '@mui/material/Button';\nimport TextField from '@mui/material/TextField';\nimport SendIcon from '@mui/icons-material/Send';\nimport io from \"socket.io-client\";\nimport LogText from \"./LogText\"\nimport Box from '@mui/material/Box';\n//#endregion\n\n//#region CSS Style\nconst style = {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    transform: 'translate(-50%, -50%)',\n    bgcolor: 'background.paper',\n    height: '80%',\n    width: '40%',\n    border: '2px solid #000',\n    pt: 2,\n    px: 4,\n    pb: 3,\n};\n//#endregion\n\n//#region 전역 변수\nlet socket;\n//#endregion\n\n\nfunction Chatting(props) {\n\n    const ENDPOINT = \"http://localhost:8080\";\n\n    const { value , buyer_name } = props;\n\n    //#region useState\n    const [modalIsOpen, setIsOpen] = useState(false);\n    const [chat_log, set_Chatlog] = useState([{}]);\n    const [send_msg, set_SendMsg] = useState(\"\");\n    const [Room_Number] = useState(value); \n    //#endregion\n   \n    let room_number = 0;\n    \n    //#region 함수가 실행될때 modal의 상태를 true로 바꿔준다.\n    function openModal() {\n        room_number=Room_Number;\n        socket.emit(\"Chatting_Join\",{room_number});\n        socket.on('Join_return',({room_number})=>{\n            console.log(\"성공\");\n        })\n        socket.emit(\"Load_Msg_Chat\",{Room_Number});\n        socket.on('Return_Load_Msg_Chat',({result})=> {\n            set_Chatlog(result);\n        })\n        setIsOpen(true);\n        \n    }\n    //#endregion\n\n    //#region 함수가 실행될때 modal의 상태를 false로 바꿔준다. \n    function closeModal() {\n        setIsOpen(false);\n    }\n    //#endregion\n\n    //#region useEffect\n    useEffect(() => {\n        socket = io(ENDPOINT);        \n    }, [ENDPOINT]);\n\n    useEffect(()=>{\n        \n        socket.on(\"Msg_return\", ({ buyer_name, send_msg }) => {\n            console.log(\"신호\");\n            set_Chatlog([...chat_log, { name: buyer_name, msg: send_msg }]);\n        })\n        if(chat_log.length !== 0 && chat_log.length !== 1) {\n            socket.emit(\"Save_Msg\",({chat_log, Room_Number}));\n        }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    },[chat_log]);\n    //#endregion\n\n    //#region 메세지 전달 함수\n    function SendMessage() {\n        \n        socket.emit(\"Message_Send\", { buyer_name, send_msg, Room_Number });        \n    }\n    //#endregion\n\n    //#region 렌더링\n    return (\n        <React.Fragment>\n            <Button onClick={openModal}>Chatting</Button>\n            <Modal\n                hideBackdrop\n                open={modalIsOpen}\n                onClose={closeModal}\n                aria-labelledby=\"child-modal-title\"\n                aria-describedby=\"child-modal-description\"\n            >\n                <Box sx={{ ...style }}>\n                    <LogText log={chat_log} ></LogText>\n                    <TextField\n                        margin='normal'\n                        required\n                        fullWidth\n                        id=\"Message\"\n                        label=\"Message\"\n                        name=\"Message\"\n                        autoComplete=\"Message\"\n                        autoFocus\n                        onChange={(e) => set_SendMsg(e.target.value)}\n                    />\n                    <ButtonGroup disableElevation variant=\"contained\">\n                        <Button variant=\"contained\" onClick={() => { closeModal() }}>CLOSE</Button>\n                        <Button variant=\"contained\" endIcon={<SendIcon />} onClick={() => { SendMessage() }} >SEND</Button>\n                    </ButtonGroup>\n                </Box>\n            </Modal>\n        </React.Fragment>\n    );\n    //#endregion\n}\n\nexport default Chatting;"],"mappings":"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"},"metadata":{},"sourceType":"module"}