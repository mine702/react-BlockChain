{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\2022\\\\truffle\\\\react-BlockChain-truffle\\\\react-BlockChain-truffle\\\\front\\\\client\\\\src\\\\component\\\\ui\\\\Chatting.jsx\",\n    _s = $RefreshSig$();\n\n//#region react\nimport React, { useState, useEffect } from 'react'; //#endregion\n//#region mui\n\nimport ButtonGroup from '@mui/material/ButtonGroup';\nimport Modal from '@mui/material/Modal';\nimport Button from '@mui/material/Button';\nimport TextField from '@mui/material/TextField';\nimport SendIcon from '@mui/icons-material/Send';\nimport io from \"socket.io-client\";\nimport LogText from \"./LogText\";\nimport Box from '@mui/material/Box'; //#endregion\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst style = {\n  position: 'absolute',\n  top: '50%',\n  left: '50%',\n  transform: 'translate(-50%, -50%)',\n  bgcolor: 'background.paper',\n  height: '80%',\n  width: '40%',\n  border: '2px solid #000',\n  pt: 2,\n  px: 4,\n  pb: 3\n};\nlet socket;\n\nfunction Chatting(props) {\n  _s();\n\n  const ENDPOINT = \"http://localhost:8080\";\n  const {\n    value,\n    buyername\n  } = props;\n  const [modalIsOpen, setIsOpen] = useState(false);\n  const [chatlog, setChatlog] = useState([{}]);\n  const [sendmsg, setSendMsg] = useState(\"\");\n  const [RoomNumber] = useState(value);\n  let roomnumber = 0; // 함수가 실행될때 modal의 상태를 true로 바꿔준다.\n\n  function openModal() {\n    roomnumber = RoomNumber;\n    socket.emit(\"Chatting_Join\", {\n      roomnumber\n    });\n    socket.on('Join_return', _ref => {\n      let {\n        roomnumber\n      } = _ref;\n      console.log(\"성공\");\n    });\n    socket.emit(\"Load_Msg_Chat\", {\n      RoomNumber\n    });\n    socket.on('Return_Load_Msg_Chat', _ref2 => {\n      let {\n        result\n      } = _ref2;\n      setChatlog(result); //setChatlog([...chatlog, { name: Oname, msg: sendmsg }]);\n    });\n    setIsOpen(true);\n  } // 함수가 실행될때 modal의 상태를 false로 바꿔준다.\n\n\n  function closeModal() {\n    setIsOpen(false);\n  }\n\n  useEffect(() => {\n    socket = io(ENDPOINT); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [ENDPOINT]);\n  useEffect(() => {\n    socket.on(\"Msg_return\", _ref3 => {\n      let {\n        buyername,\n        sendmsg\n      } = _ref3;\n      console.log(\"신호\");\n      setChatlog([...chatlog, {\n        name: buyername,\n        msg: sendmsg\n      }]);\n    });\n\n    if (chatlog.length !== 0 && chatlog.length !== 1) {\n      socket.emit(\"Save_Msg\", {\n        chatlog,\n        RoomNumber\n      });\n    }\n  }, [chatlog]);\n\n  function SendMessage() {\n    socket.emit(\"Message_Send\", {\n      buyername,\n      sendmsg,\n      RoomNumber\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      onClick: openModal,\n      children: \"Chatting\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      hideBackdrop: true,\n      open: modalIsOpen,\n      onClose: closeModal,\n      \"aria-labelledby\": \"child-modal-title\",\n      \"aria-describedby\": \"child-modal-description\",\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        sx: { ...style\n        },\n        children: [/*#__PURE__*/_jsxDEV(LogText, {\n          log: chatlog\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          margin: \"normal\",\n          required: true,\n          fullWidth: true,\n          id: \"Message\",\n          label: \"Message\",\n          name: \"Message\",\n          autoComplete: \"Message\",\n          autoFocus: true,\n          onChange: e => setSendMsg(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(ButtonGroup, {\n          disableElevation: true,\n          variant: \"contained\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            onClick: () => {\n              closeModal();\n            },\n            children: \"CLOSE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            endIcon: /*#__PURE__*/_jsxDEV(SendIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 62\n            }, this),\n            onClick: () => {\n              SendMessage();\n            },\n            children: \"SEND\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Chatting, \"SQcQraRZ+CfgbZJFb3j6O5VrrZs=\");\n\n_c = Chatting;\nexport default Chatting;\n\nvar _c;\n\n$RefreshReg$(_c, \"Chatting\");","map":{"version":3,"names":["React","useState","useEffect","ButtonGroup","Modal","Button","TextField","SendIcon","io","LogText","Box","style","position","top","left","transform","bgcolor","height","width","border","pt","px","pb","socket","Chatting","props","ENDPOINT","value","buyername","modalIsOpen","setIsOpen","chatlog","setChatlog","sendmsg","setSendMsg","RoomNumber","roomnumber","openModal","emit","on","console","log","result","closeModal","name","msg","length","SendMessage","e","target"],"sources":["C:/Users/user/Desktop/2022/truffle/react-BlockChain-truffle/react-BlockChain-truffle/front/client/src/component/ui/Chatting.jsx"],"sourcesContent":["//#region react\r\nimport React, { useState, useEffect } from 'react';\r\n//#endregion\r\n\r\n//#region mui\r\nimport ButtonGroup from '@mui/material/ButtonGroup';\r\nimport Modal from '@mui/material/Modal';\r\nimport Button from '@mui/material/Button';\r\nimport TextField from '@mui/material/TextField';\r\nimport SendIcon from '@mui/icons-material/Send';\r\nimport io from \"socket.io-client\";\r\nimport LogText from \"./LogText\"\r\nimport Box from '@mui/material/Box';\r\n//#endregion\r\n\r\nconst style = {\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: '50%',\r\n    transform: 'translate(-50%, -50%)',\r\n    bgcolor: 'background.paper',\r\n    height: '80%',\r\n    width: '40%',\r\n    border: '2px solid #000',\r\n    pt: 2,\r\n    px: 4,\r\n    pb: 3,\r\n};\r\n\r\nlet socket;\r\n\r\nfunction Chatting(props) {\r\n\r\n    const ENDPOINT = \"http://localhost:8080\";\r\n\r\n    const { value , buyername } = props\r\n\r\n    const [modalIsOpen, setIsOpen] = useState(false);\r\n    const [chatlog, setChatlog] = useState([{}]);\r\n    const [sendmsg, setSendMsg] = useState(\"\");\r\n    const [RoomNumber] = useState(value); \r\n\r\n   \r\n    let roomnumber = 0;\r\n    \r\n    // 함수가 실행될때 modal의 상태를 true로 바꿔준다.\r\n    function openModal() {\r\n        roomnumber=RoomNumber;\r\n        socket.emit(\"Chatting_Join\",{roomnumber});\r\n        socket.on('Join_return',({roomnumber})=>{\r\n            console.log(\"성공\");\r\n        })\r\n        socket.emit(\"Load_Msg_Chat\",{RoomNumber});\r\n        socket.on('Return_Load_Msg_Chat',({result})=> {\r\n            setChatlog(result);\r\n        //setChatlog([...chatlog, { name: Oname, msg: sendmsg }]);\r\n        })\r\n        setIsOpen(true);\r\n        \r\n    }\r\n\r\n    // 함수가 실행될때 modal의 상태를 false로 바꿔준다.\r\n    function closeModal() {\r\n        setIsOpen(false);\r\n    }\r\n\r\n\r\n    useEffect(() => {\r\n        socket = io(ENDPOINT);        \r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [ENDPOINT]);\r\n\r\n    useEffect(()=>{\r\n        \r\n        socket.on(\"Msg_return\", ({ buyername, sendmsg }) => {\r\n            console.log(\"신호\");\r\n            setChatlog([...chatlog, { name: buyername, msg: sendmsg }]);\r\n        })\r\n        if(chatlog.length !== 0 && chatlog.length !== 1)\r\n        {\r\n            socket.emit(\"Save_Msg\",({chatlog, RoomNumber}));\r\n        }\r\n    },[chatlog]);\r\n\r\n    function SendMessage() {\r\n        \r\n        socket.emit(\"Message_Send\", { buyername, sendmsg, RoomNumber });        \r\n    }\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <Button onClick={openModal}>Chatting</Button>\r\n            <Modal\r\n                hideBackdrop\r\n                open={modalIsOpen}\r\n                onClose={closeModal}\r\n                aria-labelledby=\"child-modal-title\"\r\n                aria-describedby=\"child-modal-description\"\r\n            >\r\n                <Box sx={{ ...style }}>\r\n                    <LogText log={chatlog} ></LogText>\r\n                    <TextField\r\n                        margin='normal'\r\n                        required\r\n                        fullWidth\r\n                        id=\"Message\"\r\n                        label=\"Message\"\r\n                        name=\"Message\"\r\n                        autoComplete=\"Message\"\r\n                        autoFocus\r\n                        onChange={(e) => setSendMsg(e.target.value)}\r\n                    />\r\n                    <ButtonGroup disableElevation variant=\"contained\">\r\n                        <Button variant=\"contained\" onClick={() => { closeModal() }}>CLOSE</Button>\r\n                        <Button variant=\"contained\" endIcon={<SendIcon />} onClick={() => { SendMessage() }} >SEND</Button>\r\n                    </ButtonGroup>\r\n                </Box>\r\n            </Modal>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport default Chatting;"],"mappings":"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"},"metadata":{},"sourceType":"module"}